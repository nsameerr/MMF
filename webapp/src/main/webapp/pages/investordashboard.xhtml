<?xml version="1.0" encoding="windows-1252"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <head>
        <title>TODO supply a title</title>

    </head>
    <body>
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-WV7G82"
                    height="0" width="0" style="display:none;visibility:hidden">
            </iframe>
        </noscript>
        <script>
            (function(w, d, s, l, i) {
                w[l] = w[l] || [];
                w[l].push({'gtm.start':
                new Date().getTime(), event: 'gtm.js'});
                var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l !== 'dataLayer' ? '&amp;l=' + l : '';
                j.async = true;
                j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl;
                f.parentNode.insertBefore(j, f);
            })(window, document, 'script', 'dataLayer', 'GTM-WV7G82');        
        </script>
         <script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		
		  ga('create', 'UA-69307705-1', 'auto');
		  ga('send', 'pageview');
	</script>
        <!-- End Google Tag Manager -->
        
        <ui:composition template="/pages/template/content_page_layout.xhtml">
            <ui:define name="title">
                <h:outputText value="Investor Dashboard" />
            </ui:define>
            <ui:define name="sidebar">
                <ui:include src="/pages/template/components/sidebar_user.xhtml" />
            </ui:define>
            <ui:define name="content">
                <link rel="stylesheet"
                      href="#{request.contextPath}/css/compiled/chart-showcase.css"
                      type="text/css" media="screen" />
                <link rel="stylesheet"
                      href="#{request.contextPath}/css/compiled/tables.css"
                      type="text/css" media="screen" />
                <link id="skin-file" href="#{request.contextPath}/css/skins/dark.css"
                      type="text/css" rel="stylesheet" />
                <script src="#{request.contextPath}/js/jquery.js"></script>
                <script src="#{request.contextPath}/js/jquery-ui-1.10.2.custom.min.js"></script>

                <!-- flot charts -->
                <script src="#{request.contextPath}/js/jquery-1.8.3.min.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.min.js"></script>               
                <script src="#{request.contextPath}/js/jquery.flot.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.selection.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.symbol.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.time.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.crosshair.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.axislabels.js"></script>
                <script src="#{request.contextPath}/js/curvedLines.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.navigationControl.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.navigate.js"></script>
                <script src="#{request.contextPath}/js/jquery.flot.rangeselection.js">
                </script>
                <script src="#{request.contextPath}/js/jquery.flot.resize.js"></script>
				<script src="#{request.contextPath}/pages/v2/js/clevertap.js"></script>
                <style TYPE="text/css">
                    .pan-left{
                        left:0px;
                        top: 0px;
                    }
                    .pan-right{
                        left:1000px;
                        top: 0px;
                    }
                    #legendContainer {
                        background-color: #f5f5f5;
                        padding: 2px;
                        margin-bottom: 8px;
                        border-radius: 3px 3px 3px 3px;
                        border: 1px solid #E6E6E6;
                        display: inline-block;
                        margin: 0 auto;
                    }
                    .demo-container {
                        box-sizing: border-box;
                        width: 98%;
                        height: 400px;
                        padding: 10px 10px 10px 10px;
                        margin: 10px auto 10px auto;
                        border: 1px solid #ddd;
                        background: #fff;
                        background: linear-gradient(#f6f6f6 0, #fff 50px);
                        background: -o-linear-gradient(#f6f6f6 0, #fff 50px);
                        background: -ms-linear-gradient(#f6f6f6 0, #fff 50px);
                        background: -moz-linear-gradient(#f6f6f6 0, #fff 50px);
                        background: -webkit-linear-gradient(#f6f6f6 0, #fff 50px);
                        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
                        -o-box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
                        -ms-box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
                        -moz-box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
                        -webkit-box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
                    }
                    @media (max-width: 767px) {
                        .demo-container{
                            margin-top: 20%;
                        }

                    }

                    .ui-dialog .ui-dialog-titlebar {
                        padding: .4em .4em .4em 1em;
                        position: relative;
                        border: 0px;
                        background: rgb(86, 195, 100);
                    }
                    .marginleft0{
                        margin-left: 0px !important;
                    }
                </style>

                <h:form>
                    <div class="content">
                        <div class="container-fluid">
                            <div id="pad-wrapper">
                                <h2 class="page-title" style="margin-bottom: 0">Investor
                                    Dashboard</h2>
                                    <script type="text/javascript">
                                    	clevertap.event.push("Investor Dashboard Visited");
                                    </script>
                                <div class="row-fluid two-baseline-margin-bottom">
                                    <div class="span12">
                                        <h3 class="title">My Portfolio</h3>
                                         <div>
                                            <center>
                                                <h:outputText id="message" value="#{investorDashBoardController.contractStartMessage}" 
                                                              rendered="#{investorDashBoardController.isContract}" style="color: red"/>
                                            </center>
                                        </div>
                                        <div class="row-fluid two-baseline-margin-bottom">

                                            <div class="row-fluid two-baseline-margin-bottom"  style="width: 99%">
                                                <c:forEach items="#{investorDashBoardController.portfolioSecurityVOlist}" var="securityList">
                                            <table style="border: 1px solid #eee; margin-bottom: 36px; width: 100% " class="table" celpadding="10">
                                            <thead style="border-top: none;">
                                                <tr>
                                                    <th>            
                                                        <div class="align_center" style="margin-left: 0px;text-align: left">
                                                            <h:outputLabel  value="CURRENT VALUE"  style="font-size: 11px; font-weight: bold" />
                                                           
                                                        </div>
                                                    </th>

                                                    <th>
                                                        <div class="align_center" style="margin-left: 0px;text-align: left">
                                                            <h:outputLabel  value="ACQUISITION VALUE"  style="font-size: 11px; font-weight: bold" />
                                                        </div>
                                                    </th>
                                                    <th>
                                                        <div class="align_center" style="margin-left: 0px;text-align: left">
                                                            <h:outputLabel  value="GAIN/LOSS"  style="font-size: 11px; font-weight: bold" />
                                                        </div>
                                                    </th>
                                                     <th>
                                                        <div class="align_center" style="margin-left: 0px;text-align: left">
                                                            <h:outputLabel  value="CASH AMOUNT"  style="font-size: 11px; font-weight: bold" />
                                                        </div>
                                                    </th>
                                                    <th>
                                                        <div class="align_center" style="margin-left: 0px;text-align: left">
                                                            <h:outputLabel  value="BLOCKED CASH AMOUNT"  style="font-size: 11px; font-weight: bold" />
                                                        </div>
                                                    </th>
                                                    <th>
                                                        <div class="align_center" style="margin-left: 0px;text-align: left">
                                                            <h:outputLabel  value="RETURN"  style="font-size: 11px; font-weight: bold" />
                                                        </div>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="first">
                                                    <td class="align_right">
                                                        <i class="rupees"><span class="WebRupee">Rs.</span></i> 
                                                        <h:outputLabel value="#{securityList.portfolio_currentValue} ">
                                                        <f:convertNumber pattern="#0.00"/>
                                                        </h:outputLabel>
                                                    </td>
                                                    <td class="align_right">
							   <i class="rupees"><span class="WebRupee">Rs.</span></i> 
                                                        <h:outputLabel value="#{securityList.acquisitonValue}">
                                                           <f:convertNumber pattern="#0.00"/>
                                                        </h:outputLabel>
                                                    </td> 
                                                    <td class="align_right">
						   <i class="rupees"><span class="WebRupee">Rs.</span></i> 
                                                        <h:outputLabel value=" #{securityList.totalGainLoss}">
                                                             <f:convertNumber pattern="#0.00"/>
                                                        </h:outputLabel>
                                                    </td> 
                                                    <td class="align_right">
                                                        <i class="rupees"><span class="WebRupee">Rs.</span></i> 
                                                        <h:outputLabel value="#{securityList.cash_amount}">
                                                            <f:convertNumber pattern="#00.00" />
                                                        </h:outputLabel>
                                                    </td>
                                                    <td class="align_right">
                                                        <i class="rupees"><span class="WebRupee">Rs.</span></i> 
                                                        <h:outputLabel value="#{securityList.blockedcash}">
                                                            <f:convertNumber pattern="#00.00" />
                                                        </h:outputLabel>
                                                    </td>
                                                    <td class="align_right">
                                                        <h:outputLabel value="#{securityList.dashbrd_return}">
                                                            <f:convertNumber pattern="#00.00"/>
                                                        </h:outputLabel>%
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                                </c:forEach> 
                                            </div>  

                                        </div>

                                        <div class="btn-group pull-left">
                                            <button type="button" class="glow left" id="five-day"
                                                    value="5" >5d</button>
                                            <button type="button" class="glow middle" id="one-month"
                                                    value="30">1m</button>
                                            <button type="button" class="glow middle" id="three-month"
                                                    value="90">3m</button>
                                            <button type="button" class="glow middle" id="six-month"
                                                    value="180">6m</button>
                                            <button type="button" class="glow middle" id="year-to-date"
                                                    >YTD</button>
                                            <button type="button" class="glow middle" id="one-year"
                                                    value="365">1y</button>
                                            <button type="button" class="glow middle" id="five-year"
                                                    value="1825">5y</button>
                                            <button type="button" class="glow middle" id="ten-year"
                                                    value="3650">10y</button>
                                            <button type="button" class="glow middle" id="whole"
                                                    value="3650">All</button>
                                        </div>
                                        <p:remoteCommand name="clickdatebutton"
                                                         actionListener="#{headerController.onClickReturnDays()}"
                                                         update="linechartGraph" />
                                        <div class="btn-group pull-right"
                                             style="font-size: 10px; color: blue">
                                            Scale:<br/> X-axis: 1 Unit = Day/Month/Year
                                        </div>

                                        <div class="span12 no_lft_margin">
                                            <div class="demo-container" >
                                                <div id="statsChart" style="height: 300px;margin:0 auto"></div>
                                                <div id="legendContainer" style="margin-left: 2%;margin-top:1%"></div> 
                                                <p id="choices" style="float:right; width:150px;"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <h3 class="title no-margin-bottom">Notifications</h3>
                                <h:panelGroup
                                    rendered="#{headerController.investorNotifications.size()==0}">
                                    <div class="row notification">
                                        <div class="span8">
                                            <span>No new notifications for you.</span>
                                        </div>
                                    </div>
                                </h:panelGroup>
                                <ui:repeat value="#{headerController.investorNotifications}"
                                           var="notification"
                                           rendered="#{headerController.investorNotifications.size()>0}">
                                    <div class="row notification">
                                        <div class="span8">
                                            <span><h:outputText
                                                    value="#{notification.notificationMessage}" /></span>
                                        </div>
                                        <div class="span2 pull-right">
                                            <h:commandLink styleClass="btn-flat success"
                                                           rendered="#{notification.viewButtonDispStatus}"
                                                           actionListener="#{headerController.doActionRedirectToINV()}"
                                                           action="#{headerController.getRedirectToINV()}">
                                                #{notification.buttonText}
                                                <f:param name="index"
                                                         value="#{headerController.investorNotifications.indexOf(notification)}_false" />
                                            </h:commandLink>
                                        </div>
                                    </div>
                                </ui:repeat>
                            </div>
                        </div>
                    </div>

                    <p:dialog  id="dialog" resizable="false" closable="false" header="LinkedIn Connection Success"
                               style="display: block;height: auto;width: 500px; margin-left: 50%; margin-top: 20%;"  widgetVar="dialog" 
                               modal="true" showEffect="fade" hideEffect="fade" draggable="true" visible="#{headerController.linkedInConnectedSuccess}"
                               rendered="#{headerController.linkedInConnectedSuccess}"> 
                        <h:panelGroup  id="oms_msg" rendered="#{headerController.linkedInConnectedSuccess}">
                            <div class="content-wrap">
                                <table width="100%" height="100%" class="outerTable">
                                    <tbody><tr>
                                            <td valign="middle" class="outerTableCell">
                                                <table class="loginTable" border="0" align="center" cellpadding="0" cellspacing="0">
                                                    <tbody>
                                                        <tr>
                                                            <td colspan="2" class="login_input">
                                                                <h:outputText value="Connected to LinkedIN Successfully">

                                                                </h:outputText>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2" class="login_submitCell">
                                                                <h:commandButton styleClass="login_submit" value="OK"
                                                                                 actionListener="#{headerController.hideDialogLinkedinSuccess()}"
                                                                                 onclick="PF('dialog').hide();" >
                                                                </h:commandButton>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </h:panelGroup>
                    </p:dialog>


                    <script type="text/javascript">

                        function  onClickDateButton(elm) {
                            var dayValue = elm.value;
                            clickdatebutton([{name: 'dayValue', value: dayValue}]);
                        }

                        function getCurrentDayOfyer() {
                            var timestmp = new Date().setFullYear(new Date().getFullYear(), 0, 1);
                            var yearFirstDay = Math.floor(timestmp / 86400000);
                            var today = Math.ceil((new Date().getTime()) / 86400000);
                            clickdatebutton([{name: 'dayValue', value: (today - yearFirstDay)}]);
                        }
                    </script>

                    <h:panelGroup id="linechartGraph">
                        <script type="text/javascript">
                            //<![CDATA[	
                            var $j = jQuery.noConflict();
                            $j(document).ready(function () {
                                var plot;
                                var legends;
                                var benchmark = #{headerController.benchMarkLineChartData};
                                var self = #{headerController.selfLineChartData};
                                var recommended = #{headerController.recommendedLineChartData};
                                var days = #{headerController.nodays};
                                var category = #{headerController.jsonCategory};
                                var dateformat = #{headerController.jsonDateFormat};
                                var mxYvalue = #{headerController.maxYavalue};
                                var portfolioAssigneddate = #{headerController.portfolioAssignedDate};
                                var portfoliodate = #{headerController.portfolioDate};
                                var fiveDays = #{headerController.fivedays};
                                var oneMonth = #{headerController.oneMonth};
                                var threeMonth = #{headerController.threeMonth};
                                var sixMonth = #{headerController.sixMonth};
                                var oneYear = #{headerController.oneYear};
                                var fiveYear = #{headerController.fiveYear};
                                var tenYear = #{headerController.tenYear};
                                var axes;
                                var dataset = [
                                    {
                                        yaxis: 1,
                                        label: "Benchmark ",
                                        data: benchmark, color: "#000000"
                                    }, {
                                        yaxis: 1,
                                        label: "Self ",
                                        data: self, color: "#008000"
                                    },
                                    {
                                        yaxis: 1,
                                        label: "Recommended ",
                                        data: recommended, color: "#A9A9A9"
                                    }
                                ];
                                function gd(year, month, day) {
                                    return new Date(year, month, day).getTime();
                                }
                                var ccommenSeries = {
                                    lines: {
                                        show: true,
                                        lineWidth: 2,
                                        fill: true,
                                        fillColor: {
                                            colors: [{opacity: 0.05},
                                                {opacity: 0.09}]
                                        }
                                    },
                                    points: {
                                        show: false,
                                        lineWidth: 3,
                                        radius: 1
                                    },
                                    shadowSize: 0,
                                    stack: true
                                };
                                var ccurvedLines = {
                                    apply: true,
                                    active: true,
                                    monotonicFit: true
                                };
                                var ccrosshair = {
                                    mode: "xy"
                                };
                                var cgrid = {
                                    hoverable: true,
                                    clickable: true,
                                    tickColor: '#FFE4B5',
                                    borderWidth: 1,
                                    autoHighlight: true
                                };
                                var czoom = {
                                    interactive: false,
                                    trigger: "dblclick", // or "click" for single click
                                    amount: 1.5         // 2 = 200% (zoom in), 0.5 = 50% (zoom out)
                                };
                                var cyaxes = [
                                    {
                                        position: "left",
                                        color: "#008000",
                                        // axisLabel: "Self",
                                        axisLabelUseCanvas: true,
                                        axisLabelFontSizePixels: 14,
                                        axisLabelPadding: 3, //
                                        panRange: false,
                                        zoomRange: false
                                    }];
                                var wholeXaxis = {
                                    color: '#000000',
                                    timeformat: "%d/%m/%Y",
                                    minTickSize: [1, "day"],
                                    mode: "time",
                                    min: parseInt(portfolioAssigneddate),
                                    max: new Date().getTime(),
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 5
                                };
                                var oneYearXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(oneYear),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 2
                                };
                                var fiveDayXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(fiveDays),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 2
                                };
                                var oneMonthDayXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(oneMonth),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 2
                                };
                                var threeMonthDayXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(threeMonth),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 5
                                };
                                var sixMonthDayXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(sixMonth),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 5
                                };
                                var fiveYearDayXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(fiveYear),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 5

                                };
                                var tenYearDayXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: parseInt(tenYear),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 5
                                };
                                var ytdXaxis = {
                                    mode: "time",
                                    minTickSize: [1, "day"],
                                    min: (new Date(new Date().getFullYear(), 0, 1)).getTime(),
                                    max: new Date().getTime(),
                                    timeformat: "%d/%m/%Y",
                                    panRange: [new Date(parseInt(portfolioAssigneddate)), new Date()],
                                    zoomRange: [null, new Date()],
                                    ticks: 5
                                };
                                var clegend = {
                                    noColumns: 1,
                                    labelFormatter: function (label, series) {
                                        return  label;
                                    },
                                    container: $j("#legendContainer"),
                                    backgroundColor: "white",
                                    backgroundOpacity: 0.9,
                                    labelBoxBorderColor: "#000000",
                                    position: "nw"
                                };
                                var options = {
                                    series: ccommenSeries,
                                    curvedLines: ccurvedLines,
                                    crosshair: ccrosshair,
                                    grid: cgrid,
                                    yaxes: cyaxes,
                                    xaxis: wholeXaxis,
                                    legend: clegend,
                                    zoom: czoom,
                                    pan: {
                                        interactive: true
                                    }
                                };



                                var choiceContainer = $j("#choices");
                                choiceContainer.empty();
                                $j.each(dataset, function (key, val) {
                                    choiceContainer.append("<input type='checkbox' name='" + key +
                                            "' checked='checked' id='id" + key + "'></input>" +
                                            "<label for='id" + key + " ' style ='color:" + dataset[key].color + "'>"
                                            + val.label + "</label></br>");
                                });

                                choiceContainer.find("input").click(plotAccordingToChoices);
                                // this function is uded for togging the data series
                                function plotAccordingToChoices() {

                                    var data = [];

                                    choiceContainer.find("input:checked").each(function () {
                                        var key = $j(this).attr("name");
                                        if (key && dataset[key]) {
                                            data.push(dataset[key]);
                                        }
                                    });
                                    if (data.length > 0) {
                                        plot = $j.plot("#statsChart", data, options);
                                        legends = $j("#legendContainer .legendLabel");

                                    }
                                }
                                plotAccordingToChoices();
                                plot = $j.plot($j("#statsChart"), dataset, options);
                                $j("#statsChart").UseTooltip();
                                $j("#whole").click(function () {
                                    makeSelectionVisible(this)
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: wholeXaxis,
                                        legend: clegend, zoom: czoom,
                                        pan: {
                                            interactive: true
                                        }
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });

                                //function for showing different time period data      
                                $j("#five-day").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: fiveDayXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#one-month").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: oneMonthDayXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#three-month").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: threeMonthDayXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#six-month").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: sixMonthDayXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#one-year").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: oneYearXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#year-to-date").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: ytdXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#five-year").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: fiveYearDayXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                $j("#ten-year").click(function () {
                                    makeSelectionVisible(this);
                                    options = {
                                        series: ccommenSeries,
                                        curvedLines: ccurvedLines,
                                        crosshair: ccrosshair,
                                        grid: cgrid,
                                        yaxes: cyaxes,
                                        xaxis: tenYearDayXaxis,
                                        legend: clegend,
                                        pan: {
                                            interactive: true
                                        }, zoom: czoom
                                    };
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });
                                var rangeselectionCallback = function (o) {
                                    console.log("New selection:" + o.start + "," + o.end);
                                    var xaxis = plot.getAxes().xaxis;
                                    xaxis.options.min = o.start;
                                    xaxis.options.max = o.end;
                                    plot.setupGrid();
                                    plot.draw();
                                    legends = $j("#legendContainer .legendLabel");
                                }
                                var sData = $j.extend(true, [], dataset);
                                for (var i = 0; i < sData.length; i++) {
                                    sData[i].color = '#ccc';
                                    sData[i].label = undefined;
                                }

                                //cross hair label updation   
                                var legends = $j("#legendContainer .legendLabel");
                                var updateLegendTimeout = null;
                                var latestPosition = null;
                                function updateLegend() {
                                    updateLegendTimeout = null;
                                    var pos = latestPosition;
                                    axes = plot.getAxes();
                                    if (pos.x < axes.xaxis.min || pos.x > axes.xaxis.max || pos.y < axes.yaxis.min || pos.y > axes.yaxis.max)
                                        return;
                                    var i, j, dataset = plot.getData();
                                    for (i = 0; i < dataset.length; ++i) {
                                        var series = dataset[i];
                                        // find the nearest points, x-wise
                                        for (j = 0; j < series.data.length; ++j)
                                            if (series.data[j][0] > pos.x)
                                                break;
                                        var date;
                                        // now interpolate
                                        var y, x, p1 = series.data[j - 1],
                                                p2 = series.data[j];
                                        if (p1 === null) {
                                            y = parseFloat(p2[1]);
                                            x = new Date(parseInt(p2[0]));
                                        } else if (p2 === null) {
                                            y = parseFloat(p1[1]);
                                            x = new Date(parseInt(p1[0]));
                                        } else {
                                            y = parseFloat(p1[1]) + (parseFloat(p2[1]) - parseFloat(p1[1])) * (parseFloat(pos.x) - parseFloat(p1[0])) / (parseFloat(p2[0]) - parseFloat(p1[0]));
                                            x = new Date(parseInt(p1[0]));
                                        }
                                        legends.eq(i).text("-" + series.label.replace(/ .*/, "= " + parseFloat(y).toFixed(2)) + "-[" + x.toDateString() + "]");
                                    }
                                }
                                $j("#statsChart").bind("plothover", function (event, pos, item) {
                                    latestPosition = pos;
                                    if (!updateLegendTimeout)
                                        updateLegendTimeout = setTimeout(updateLegend, 50);
                                });
                                $j("#statsChart").bind('plotpan plotzoom', function (event, plot) {
                                    axes = plot.getAxes();
                                    axes.xaxis.options.mode = "time";
                                    axes.xaxis.options.minTickSize = [1, "day"];
                                    axes.xaxis.options.timeformat = "%d/%m/%Y";
                                    axes.xaxis.options.tickDecimals = 3;
                                    plot.setupGrid();
                                    plot.draw();
                                    legends = $j("#legendContainer .legendLabel");
                                });
                                panning = false;
                                $j("#statsChart" + ' canvas').bind('drag', function () {
                                    panning = true;
                                });
                                $j("#statsChart" + ' canvas').bind('dragend', function () {
                                    function stopPan() {
                                        panning = false;
                                    }
                                    setTimeout(stopPan, 100);
                                });
                                $j("#statsChart").resize(function () {
                                    legends = $j("#legendContainer .legendLabel");
                                });

                                $j("#statsChart").dblclick(function () {
                                    plot = $j.plot("#statsChart", dataset, options);
                                    legends = $j("#legendContainer .legendLabel");
                                    plotAccordingToChoices();
                                    $j("#statsChart").resize(function () {
                                        legends = $j("#legendContainer .legendLabel");
                                    });
                                });

                            });

                            var previousPoint = null;
                            var format = "";
                            //tooltip
                            $j.fn.UseTooltip = function () {
                                $j("#statsChart").bind("plothover", function (event, pos, item) {
                                    if (item) {
                                        if (previousPoint != item.dataIndex) {
                                            previousPoint = item.dataIndex;
                                            $j("#tooltip").remove();
                                            var x = item.datapoint[0].toFixed(0),
                                                    y = parseInt(item.datapoint[1].toFixed(0)) - parseInt(item.datapoint[2].toFixed(0));
                                            y = numberWithCommas(y);
                                            z = item.series.color;
                                            var d = new Date(parseInt(x));
                                            var dateValue;
                                            dateValue = d.toDateString();
                                            // }
                                            console.log("date:  " + dateValue);
                                            showTooltip(item.pageX, item.pageY, dateValue + " : " + y + "(" + item.series.label.replace(/ .*/, "") + ")", z);

                                        }
                                    } else {
                                        $j("#tooltip").remove();
                                        previousPoint = null;
                                    }
                                });
                            };

                            function showTooltip(x, y, contents, z) {
                                $j('<div id="tooltip">' + contents + '</div>').css({
                                    position: 'absolute',
                                    display: 'none',
                                    top: y - 30,
                                    left: x - 100,
                                    color: '#FFF8DC',
                                    padding: '2px 5px',
                                    border: '2px solid #4572A7',
                                    'border-radius': '10px 10px 10px 10px',
                                    'background-color': '#000',
                                    opacity: 0.80,
                                    'border-color': z,
                                    'font-weight': 'bold',
                                    'font-size': 14,
                                    'font-family': 'Times New Roman'

                                }).appendTo('body').fadeIn(200);
                            }
                            //]]>

                            $("#whole").css('color', 'blue');
                            function makeSelectionVisible(selection) {
                                $("#five-day").css('color', 'black');
                                $("#one-month").css('color', 'black');
                                $("#three-month").css('color', 'black');
                                $("#six-month").css('color', 'black');
                                $("#one-year").css('color', 'black');
                                $("#year-to-date").css('color', 'black');
                                $("#five-year").css('color', 'black');
                                $("#ten-year").css('color', 'black');
                                $("#whole").css('color', 'black');
                                $(selection).css('color', 'blue');
                            }

                            function numberWithCommas(x) {
                                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            }
                        </script>

                    </h:panelGroup>
                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>
